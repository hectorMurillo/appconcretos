(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Permisos"],{"64cf":function(e,n,t){"use strict";t.r(n);var o=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"container"},[e._m(0),t("div",{staticClass:"row mt-3"},[e._m(1),t("div",{staticClass:"col-12 col-md-10"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.usuarioSeleccionado,expression:"usuarioSeleccionado"}],staticClass:"form-control",on:{change:[function(n){var t=Array.prototype.filter.call(n.target.options,(function(e){return e.selected})).map((function(e){var n="_value"in e?e._value:e.value;return n}));e.usuarioSeleccionado=n.target.multiple?t:t[0]},e.cambiarUsuario]}},e._l(e.Usuarios,(function(n){return t("option",{key:n.codigo,domProps:{value:n}},[e._v(" "+e._s(n.nombreCompleto)+" ")])})),0)])]),t("div",{staticClass:"row mt-2"},[e._m(2),t("div",{staticClass:"col-12 col-md-10"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.moduloSeleccionado,expression:"moduloSeleccionado"}],staticClass:"form-control",on:{change:[function(n){var t=Array.prototype.filter.call(n.target.options,(function(e){return e.selected})).map((function(e){var n="_value"in e?e._value:e.value;return n}));e.moduloSeleccionado=n.target.multiple?t:t[0]},e.cambiarModulo]}},e._l(e.Modulos,(function(n){return t("option",{key:n.idOpcion,domProps:{value:n}},[e._v(" "+e._s(n.opcion)+" ")])})),0)])]),t("div",{staticClass:"row"},[t("div",{staticClass:"col-12"},[t("div",{staticClass:"table-responsive table-sm my-2 tableFixHead"},[t("table",{staticClass:"table table-striped"},[e._m(3),t("tbody",e._l(e.Funciones,(function(n,o){return t("tr",{key:o},[t("td",{domProps:{textContent:e._s(n.opcion)}}),t("td",{staticStyle:{"text-align":"center"}},[t("b-check",{model:{value:n.lectura,callback:function(t){e.$set(n,"lectura",t)},expression:"funcion.lectura"}})],1),t("td",{staticStyle:{"text-align":"center"}},[t("b-check",{model:{value:n.escritura,callback:function(t){e.$set(n,"escritura",t)},expression:"funcion.escritura"}})],1)])})),0)])])])]),t("div",{staticClass:"row mt-3"},[t("div",{staticClass:"col-12 offset-sm-4 col-sm-4 col-lg-4"},[t("button",{staticClass:"btn btn-danger col-12 mb-1",on:{click:e.Cancelar}},[e._v(" Cancelar ")])]),t("div",{staticClass:"col-12 col-sm-4 col-lg-4"},[t("button",{staticClass:"btn btn-success col-12 mb-1",on:{click:e.GuardarFunciones}},[t("i",{staticClass:"fa fa-save"}),e._v(" Guardar ")])])])])},r=[function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"mt-3"},[t("h3",[t("i",{staticClass:"fas fa-cogs"}),e._v(" Permisos")])])},function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"col-12 col-md-2"},[t("label",[e._v("Usuario:")])])},function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"col-12 col-md-2"},[t("label",[e._v("Modulo:")])])},function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("thead",[t("tr",[t("th",{staticStyle:{width:"340px"}},[e._v("Función")]),t("th",{staticStyle:{width:"80px","text-align":"center"}},[e._v("Lectura")]),t("th",{staticStyle:{width:"80px","text-align":"center"}},[e._v("Escritura")])])])}],a=(t("96cf"),t("1da1")),c=t("3d20"),i=t.n(c),s=(t("99af"),t("572a")),u={obtenerUsuarios:function(){return s["a"].get("/configuracion/usuarios").then((function(e){return e.data})).catch((function(e){console.log(e)}))},obtenerModulos:function(){return s["a"].get("/configuracion/modulos/").then((function(e){return e.data})).catch((function(e){console.log(e)}))},obtenerFunciones:function(e,n){return s["a"].get("/configuracion/funciones/".concat(e,"/").concat(n)).then((function(e){return e.data})).catch((function(e){console.log(e)}))},guardarFunciones:function(e,n,t,o){return s["a"].post("/configuracion/funciones/guardar/".concat(n,"/").concat(t,"/").concat(o),e,{headers:{"Content-Type":"application/json"}}).then((function(e){return e.data})).catch((function(e){console.log(e)}))},obtenerPermisos:function(e){return s["a"].post("/configuracion/obtener-permisos/".concat(e)).then((function(e){return e.data})).catch((function(e){console.log(e)}))}},l=u,d={data:function(){return{Usuarios:[],usuarioSeleccionado:[],Modulos:[],moduloSeleccionado:[],Funciones:[],procede:!0,tokenWebAdmin:{token:null,expiresAt:null,user:null,permisos:null}}},components:{},mounted:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.ObtenerUsuarios();case 2:return n.next=4,e.ObtenerModulos();case 4:return n.next=6,e.ObtenerFunciones();case 6:case"end":return n.stop()}}),n)})))()},created:function(){},computed:{},methods:{ObtenerUsuarios:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.$loading(!0),n.next=3,l.obtenerUsuarios().then((function(n){e.Usuarios=n.data,e.Usuarios.length>0&&(e.usuarioSeleccionado=e.Usuarios[0]),e.$loading(!1)})).catch((function(n){console.log(n),e.$loading(!1)}));case 3:case"end":return n.stop()}}),n)})))()},cambiarUsuario:function(){this.ObtenerFunciones()},ObtenerModulos:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.$loading(!0),n.next=3,l.obtenerModulos().then((function(n){e.Modulos=n.data,e.moduloSeleccionado=e.Modulos[0],e.$loading(!1)})).catch((function(n){console.log(n),e.$loading(!1)}));case 3:case"end":return n.stop()}}),n)})))()},cambiarModulo:function(){this.ObtenerFunciones()},ObtenerFunciones:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.Funciones=[],e.$loading(!0),n.next=4,l.obtenerFunciones(e.moduloSeleccionado.idOpcion,e.usuarioSeleccionado.codigo).then((function(n){e.Funciones=n.data,e.$loading(!1)})).catch((function(n){console.log(n),e.$loading(!1)}));case 4:case"end":return n.stop()}}),n)})))()},GuardarFunciones:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.FuncionesGuardar();case 2:return n.next=4,e.ObtenerPermisos();case 4:case"end":return n.stop()}}),n)})))()},Cancelar:function(){window.history.back()},FuncionesGuardar:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var t,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,i.a.fire({text:"¿Desea guardar los permisos del usuario: "+e.usuarioSeleccionado.nombreCompleto+"?",showCancelButton:!0,icon:"question",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Aceptar",cancelButtonText:"Cancelar"});case 2:if(t=n.sent,!t.value){n.next=8;break}return e.$loading(!0),o=JSON.stringify(e.Funciones),n.next=8,l.guardarFunciones(o,e.moduloSeleccionado.idOpcion,e.usuarioSeleccionado.codigo,e.usuario.idUsuario).then((function(n){n.value&&(console.log(e.usuarioSeleccionado),i.a.fire("¡EXITO!","Se modificaron los permisos al usuario: "+e.usuarioSeleccionado.nombreCompleto,"success"),e.$loading(!1))})).catch((function(n){console.log(n),e.$loading(!1)}));case 8:case"end":return n.stop()}}),n)})))()},ObtenerPermisos:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.usuarioSeleccionado.codigo!==e.usuario.idUsuario){n.next=6;break}return e.$loading(!0),n.next=4,l.obtenerPermisos(e.usuario.idUsuario).then((function(n){if(n.value){window.localStorage.removeItem("tokenWebAdmin"),e.tokenWebAdmin.token=n.data.accessToken.accessToken,e.tokenWebAdmin.expiresAt=n.data.accessToken.exp,e.tokenWebAdmin.user=JSON.stringify(n.data.user),e.tokenWebAdmin.permisos=JSON.stringify(n.data.permisos);var t=decodeURIComponent(encodeURI(e.tokenWebAdmin.user));e.tokenWebAdmin.user=t,window.localStorage.tokenWebAdmin=JSON.stringify(e.tokenWebAdmin),e.$loading(!1)}})).catch((function(n){console.log(n),e.$loading(!1)}));case 4:e.$loading(!1),location.reload();case 6:case"end":return n.stop()}}),n)})))()}}},f=d,m=(t("f3f9"),t("2877")),p=Object(m["a"])(f,o,r,!1,null,"1f94838b",null);n["default"]=p.exports},8418:function(e,n,t){"use strict";var o=t("c04e"),r=t("9bf2"),a=t("5c6c");e.exports=function(e,n,t){var c=o(n);c in e?r.f(e,c,a(0,t)):e[c]=t}},"99af":function(e,n,t){"use strict";var o=t("23e7"),r=t("d039"),a=t("e8b5"),c=t("861d"),i=t("7b0b"),s=t("50c4"),u=t("8418"),l=t("65f0"),d=t("1dde"),f=t("b622"),m=t("2d00"),p=f("isConcatSpreadable"),g=9007199254740991,v="Maximum allowed index exceeded",b=m>=51||!r((function(){var e=[];return e[p]=!1,e.concat()[0]!==e})),h=d("concat"),w=function(e){if(!c(e))return!1;var n=e[p];return void 0!==n?!!n:a(e)},x=!b||!h;o({target:"Array",proto:!0,forced:x},{concat:function(e){var n,t,o,r,a,c=i(this),d=l(c,0),f=0;for(n=-1,o=arguments.length;n<o;n++)if(a=-1===n?c:arguments[n],w(a)){if(r=s(a.length),f+r>g)throw TypeError(v);for(t=0;t<r;t++,f++)t in a&&u(d,f,a[t])}else{if(f>=g)throw TypeError(v);u(d,f++,a)}return d.length=f,d}})},bf91:function(e,n,t){},f3f9:function(e,n,t){"use strict";var o=t("bf91"),r=t.n(o);r.a}}]);
//# sourceMappingURL=Permisos.c0695988.js.map