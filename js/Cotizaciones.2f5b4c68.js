(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cotizaciones"],{1148:function(t,e,n){"use strict";var o=n("a691"),a=n("1d80");t.exports="".repeat||function(t){var e=String(a(this)),n="",r=o(t);if(r<0||r==1/0)throw RangeError("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(e+=e))1&r&&(n+=e);return n}},"159b":function(t,e,n){var o=n("da84"),a=n("fdbc"),r=n("17c2"),i=n("9112");for(var c in a){var s=o[c],u=s&&s.prototype;if(u&&u.forEach!==r)try{i(u,"forEach",r)}catch(l){u.forEach=r}}},"17c2":function(t,e,n){"use strict";var o=n("b727").forEach,a=n("a640"),r=n("ae40"),i=a("forEach"),c=r("forEach");t.exports=i&&c?[].forEach:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}},2532:function(t,e,n){"use strict";var o=n("23e7"),a=n("5a34"),r=n("1d80"),i=n("ab13");o({target:"String",proto:!0,forced:!i("includes")},{includes:function(t){return!!~String(r(this)).indexOf(a(t),arguments.length>1?arguments[1]:void 0)}})},"25f0":function(t,e,n){"use strict";var o=n("6eeb"),a=n("825a"),r=n("d039"),i=n("ad6d"),c="toString",s=RegExp.prototype,u=s[c],l=r((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),d=u.name!=c;(l||d)&&o(RegExp.prototype,c,(function(){var t=a(this),e=String(t.source),n=t.flags,o=String(void 0===n&&t instanceof RegExp&&!("flags"in s)?i.call(t):n);return"/"+e+"/"+o}),{unsafe:!0})},"408a":function(t,e,n){var o=n("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=o(t))throw TypeError("Incorrect invocation");return+t}},4160:function(t,e,n){"use strict";var o=n("23e7"),a=n("17c2");o({target:"Array",proto:!0,forced:[].forEach!=a},{forEach:a})},"498a":function(t,e,n){"use strict";var o=n("23e7"),a=n("58a8").trim,r=n("c8d2");o({target:"String",proto:!0,forced:r("trim")},{trim:function(){return a(this)}})},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var o=n("1d80"),a=n("5899"),r="["+a+"]",i=RegExp("^"+r+r+"*"),c=RegExp(r+r+"*$"),s=function(t){return function(e){var n=String(o(e));return 1&t&&(n=n.replace(i,"")),2&t&&(n=n.replace(c,"")),n}};t.exports={start:s(1),end:s(2),trim:s(3)}},"5a30a":function(t,e,n){"use strict";n("99af");var o=n("572a"),a={obtenerCotizaciones:function(t,e,n){return o["a"].get("/cotizaciones/obtener-cotizaciones/".concat(t,"/").concat(e,"/").concat(n)).then((function(t){return t.data})).catch((function(t){return t}))},guardarCotizacion:function(t){return o["a"].post("/cotizaciones/guardar",t,{headers:{"Content-Type":"application/json"}}).then((function(t){return t.data})).catch((function(t){console.log(t)}))},obtenerUltimoDescuentoCliente:function(t,e){return o["a"].get("/pedidos/obtener-descuento-cliente/".concat(t,"/").concat(e)).then((function(t){return t.data})).catch((function(t){return t}))},obtenerPDFCotizacion:function(t){return o["a"].get("/cotizaciones/obtener-cotizacion/pdf/".concat(t)).then((function(t){return t.data})).catch((function(t){return t}))},cargarProductosCotizacion:function(t){return o["a"].get("/cotizaciones/obtener-productos/".concat(t)).then((function(t){return t.data})).catch((function(t){return t}))}};e["a"]=a},"5a34":function(t,e,n){var o=n("44e7");t.exports=function(t){if(o(t))throw TypeError("The method doesn't accept regular expressions");return t}},"65a8":function(t,e,n){"use strict";n("99af");var o=n("572a"),a={eliminaDocumento:function(t){return o["a"].get("/clientes/cliente-documento/".concat(t)).then((function(t){return t.data})).catch((function(t){console.log(t)}))},documentosCliente:function(t){return o["a"].get("/clientes/documentos/".concat(t)).then((function(t){return t.data})).catch((function(t){return t}))},clientes:function(t){return null==t||void 0==t||0==t?o["a"].get("/clientes/todos").then((function(t){return t.data})).catch((function(t){return t})):o["a"].get("/clientes/".concat(t)).then((function(t){return t.data})).catch((function(t){return t}))},clientesCombo:function(){return o["a"].get("/clientes/clientes-combo").then((function(t){return t.data})).catch((function(t){return t}))},guardarDireccion:function(t){return o["a"].post("/clientes/direcciones/guardar",t,{headers:{"Content-Type":"application/json"}}).then((function(t){return t.data})).catch((function(t){console.log(t)}))},guardarContacto:function(t){return o["a"].post("/clientes/contactos/guardar",t,{headers:{"Content-Type":"application/json"}}).then((function(t){return t.data})).catch((function(t){console.log(t)}))},guardarCliente:function(t){return o["a"].post("/clientes/guardar",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){return t.data})).catch((function(t){console.log(t)}))},guardarClienteForzar:function(t){return o["a"].post("/clientes/cliente-forzar/guardar",t,{headers:{"Content-Type":"application/json"}}).then((function(t){return t.data})).catch((function(t){console.log(t)}))},guardarUsuario:function(t){return o["a"].post("/clientes/guardarUsuarioCliente",t,{headers:{"Content-Type":"application/json"}}).then((function(t){return t.data})).catch((function(t){console.log(t)}))},obtenerUsuario:function(t){return o["a"].get("/clientes/obtenerUsuarioCliente/".concat(t)).then((function(t){return t.data})).catch((function(t){console.log(t)}))},sugerirUsuario:function(t){return o["a"].get("/clientes/sugerenciaUsuario/".concat(t)).then((function(t){return t.data})).catch((function(t){console.log(t)}))},obtenerClientesAgente:function(t){return o["a"].get("/clientes/clientes-agente/".concat(t)).then((function(t){return t.data})).catch((function(t){return t}))},obtenerClientesDetenidos:function(){return o["a"].get("/clientes/clientes-detenidos/").then((function(t){return t.data})).catch((function(t){return t}))},obtenerDireccion:function(t){return o["a"].get("/clientes/direccion/".concat(t)).then((function(t){return t.data})).catch((function(t){return t}))},obtenerClientesCobranza:function(){return o["a"].get("/clientes/cobranza/").then((function(t){return t.data})).catch((function(t){return t}))},actualizarEstatusCliente:function(t,e){return o["a"].get("/clientes/actualizar-estatus/".concat(t,"/").concat(e)).then((function(t){return t.data})).catch((function(t){return t}))},obtenerSegmentos:function(){return o["a"].get("/clientes/segmentos").then((function(t){return t.data})).catch((function(t){return t}))},obtenerTiposClientes:function(){return o["a"].get("/clientes/tipos-cliente").then((function(t){return t.data})).catch((function(t){return t}))},obtenerTiposClienteCredito:function(){return o["a"].get("/clientes/tipos-cliente-credito").then((function(t){return t.data})).catch((function(t){return t}))},obtenerTiposListaPrecios:function(){return o["a"].get("/clientes/tipos-lista-precios").then((function(t){return t.data})).catch((function(t){return t}))},ObtenerHistorialCliente:function(t,e,n){return o["a"].get("/clientes/historial-cliente/".concat(t,"/").concat(e,"/").concat(n)).then((function(t){return t.data})).catch((function(t){return t}))},obtenerClientes:function(t){return o["a"].get("/clientes/obtener-clientes/".concat(t)).then((function(t){return t.data})).catch((function(t){return t}))}};e["a"]=a},8418:function(t,e,n){"use strict";var o=n("c04e"),a=n("9bf2"),r=n("5c6c");t.exports=function(t,e,n){var i=o(e);i in t?a.f(t,i,r(0,n)):t[i]=n}},"8a66":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"container mt-3 mb-5"},[n("div",{staticClass:"my-3"},[0==t.parametro?n("h3",[n("i",{staticClass:"fas fa-file-invoice-dollar"}),t._v(" registrar cotización")]):t._e(),t.parametro>0?n("h3",[n("i",{staticClass:"fas fa-file-invoice-dollar"}),t._v(" actualizar la cotización")]):t._e()]),n("hr"),n("b-row",[n("div",{staticClass:"form-group col-sm-12 col-md-6 col-lg-6 col-xl-6 mb-2"},[n("label",[t._v("Vendedor")]),n("div",{staticClass:"input-group"},[n("b-form-select",{class:{hasError:t.hasErrorVendedor},attrs:{id:"cboVendedor",options:t.vendedores,disabled:t.disabledVendedor||t.disabledCotizacion},on:{change:t.obtenerClientes},model:{value:t.cotizacion.codVendedor,callback:function(e){t.$set(t.cotizacion,"codVendedor",e)},expression:"cotizacion.codVendedor"}})],1)]),n("div",{staticClass:"form-group col-sm-12 col-md-6 col-lg-6 col-xl-6 mb-2"},[n("b-form-checkbox",{staticClass:"col-2 mb-2",attrs:{name:"check-button",checkbox:"",size:"md"},model:{value:t.cotizacion.tieneDescuento,callback:function(e){t.$set(t.cotizacion,"tieneDescuento",e)},expression:"cotizacion.tieneDescuento"}},[t._v(" Descuento ")]),t.cotizacion.tieneDescuento?n("div",{staticClass:"row"},[n("div",{staticClass:"input-group"},[n("input",{directives:[{name:"selectonfocus",rawName:"v-selectonfocus"},{name:"model",rawName:"v-model",value:t.cotizacion.porcentajeDescuento,expression:"cotizacion.porcentajeDescuento"}],staticClass:"form-control col-3 ml-3",class:{hasError:t.hasErrorDescuento},attrs:{type:"text"},domProps:{value:t.cotizacion.porcentajeDescuento},on:{blur:t.calcularDescuento,keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.calcularDescuento(e)},change:function(e){t.hasErrorDescuento=!1},input:function(e){e.target.composing||t.$set(t.cotizacion,"porcentajeDescuento",e.target.value)}}}),n("div",{staticClass:"input-group-append"},[n("span",{staticClass:"input-group-text",attrs:{id:"basic-addon2"}},[t._v("%")])])])]):t._e()],1)]),n("b-row",[n("div",{staticClass:"form-group col-sm-12 col-md-6 col-lg-6 col-xl-6 mb-2 mt-2"},[n("label",[t._v("Cliente")]),n("div",{staticClass:"input-group"},[n("b-form-select",{class:{hasError:t.hasErrorCte},attrs:{id:"cboCliente",disabled:t.disabledClientes||t.disabledCotizacion,options:t.clientes},on:{change:t.changeCliente},model:{value:t.cotizacion.codCliente,callback:function(e){t.$set(t.cotizacion,"codCliente",e)},expression:"cotizacion.codCliente"}})],1)]),n("div",{staticClass:"form-group col-sm-12 col-md-6 col-lg-6 col-xl-6 mb-2 mt-2"},[n("label",[t._v("Obras")]),n("div",{staticClass:"input-group"},[n("b-form-select",{class:{hasError:t.hasErrorObra},attrs:{id:"cboObras",disabled:t.disabledObras||t.disabledCotizacion,options:t.obras},on:{change:t.obraSeleccionada},model:{value:t.cotizacion.codObra,callback:function(e){t.$set(t.cotizacion,"codObra",e)},expression:"cotizacion.codObra"}})],1)])]),-1==t.cotizacion.codCliente||-1==t.cotizacion.codObra?n("b-row",[-1==t.cotizacion.codCliente?n("div",{staticClass:"form-group col-sm-12 col-md-6 col-lg-6 col-xl-6 mb-2"},[n("label",[t._v("Otro Cliente")]),n("div",{staticClass:"input-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.cotizacion.otroCliente,expression:"cotizacion.otroCliente"}],staticClass:"form-control",class:{hasError:t.hasErrorCte},attrs:{type:"text"},domProps:{value:t.cotizacion.otroCliente},on:{input:function(e){e.target.composing||t.$set(t.cotizacion,"otroCliente",e.target.value)}}})])]):t._e(),-1==t.cotizacion.codObra?n("div",{staticClass:"form-group col-sm-12 col-md-6 col-lg-6 col-xl-6 mb-2"},[n("label",[t._v("Otra Obra")]),n("div",{staticClass:"input-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.cotizacion.otraObra,expression:"cotizacion.otraObra"}],staticClass:"form-control",class:{hasError:t.hasErrorObra},attrs:{type:"text"},domProps:{value:t.cotizacion.otraObra},on:{input:function(e){e.target.composing||t.$set(t.cotizacion,"otraObra",e.target.value)}}})])]):t._e()]):t._e(),n("b-row",{staticClass:"d-flex justify-content-between"},[n("div",{staticClass:"col-sm-12 col-md-4 col-lg-2 mb-2"},[n("button",{staticClass:"btn btn-warning mb-2 mt-2",on:{click:t.buscarProducto}},[t._v("Buscar producto")])])]),t.listaProductos.length>0?n("b-row",{staticClass:"m-1"},[n("table",{staticClass:"table table-striped table-sm ",attrs:{id:"tablaClientes"}},[n("thead",{staticClass:"table-primary"},[n("th",[t._v("Código")]),n("th",[t._v("Producto")]),n("th",[t._v("Cantidad")]),n("th",[t._v("Precio m³")]),n("th")]),n("tbody",{ref:"tablaClientesBody"},t._l(t.listaProductos,(function(e,o){return n("tr",{key:o,attrs:{id:"row"+o}},[n("td",{domProps:{textContent:t._s(e.codProducto)}}),n("td",{domProps:{textContent:t._s(e.descripcion)}}),n("td",{domProps:{textContent:t._s(e.cantidad)}}),n("td",{domProps:{textContent:t._s(e.precioOriginal)}}),n("td",[n("button",{staticClass:"btn btn-danger btn-sm",on:{click:function(e){return t.borrarProducto(o)}}},[n("i",{staticClass:"fas fa-trash"})])])])})),0)])]):t._e(),n("hr"),n("b-row",[n("b-col",{staticClass:"col-md-6 col-sm-12 col-12",attrs:{"align-self":"end"}}),n("b-col",{staticClass:"col-md-3 col-sm-12 col-12",attrs:{"align-self":"end"}},[n("b-button",{staticClass:"mr-2 mt-2",attrs:{block:"",variant:"success"},on:{click:t.guardarCotizacion}},[n("i",{staticClass:"fa fa-save"}),t._v(" Guardar ")])],1),n("b-col",{staticClass:"col-md-3 col-sm-12 col-12",attrs:{"align-self":"end"}},[n("b-button",{staticClass:"mr-2 mt-2",attrs:{block:"",variant:"danger"},on:{click:t.cancelar}},[t._v(" Cancelar ")])],1)],1)],1),n("b-modal",{attrs:{centered:"",size:"lg",title:"Agregar un nuevo producto a la cotización"},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[n("div",{staticClass:"w-100"},[n("b-button",{staticClass:"float-right",attrs:{variant:"primary"},on:{click:t.agregarProductoCotizacion}},[t._v(" Agregar producto ")])],1)]},proxy:!0}]),model:{value:t.modalProductos,callback:function(e){t.modalProductos=e},expression:"modalProductos"}},[n("b-container",{attrs:{fluid:""}},[n("div",{staticClass:"row"},[n("div",{staticClass:"form-group col-sm-12 mb-1"},[n("label",[t._v("Fórmula")]),n("div",{staticClass:"row"},[n("div",{staticClass:"input-group col-xl-10"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.state,expression:"state"}],ref:"refFormula",staticClass:"form-control",class:{hasError:t.hasErrorProducto},attrs:{type:"text",autocomplete:"off",disabled:t.disabledCotizacion},domProps:{value:t.state},on:{input:[function(e){e.target.composing||(t.state=e.target.value)},t.filterState],focus:t.focusInputFormula}}),n("span",{staticClass:"input-group-btn"},[n("b-button",{staticClass:"input-group-4",attrs:{disabled:t.disabledFormula||t.disabledCotizacion,variant:"outline-primary"},on:{click:t.limpiarProducto}},[n("i",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])],1)])]),t.formulasFiltradas&&t.modal?n("div",[n("ul",{staticClass:"list-group items-body"},t._l(t.formulasFiltradas,(function(e){return n("li",{key:e.value,staticClass:"list-group-item py-2 items-body-content",on:{click:function(n){return t.setState(e)}}},[n("span",[t._v(" "+t._s(e.text))]),n("i",{staticClass:"fa fa-angle-right"})])})),0)]):t._e(),n("transition",{attrs:{name:"fade"}},[n("label",{directives:[{name:"show",rawName:"v-show",value:t.mostrarProducto,expression:"mostrarProducto"}]},[n("span",{staticClass:"labelSize"},[t._v("Nomenclatura: ")]),t._v(" "+t._s(t.cotizacion.producto))])])],1),n("div",{staticClass:"form-group col-sm-12 mb-2"},[n("label",[t._v("Cantidad")]),n("div",{staticClass:"input-group"},[n("input",{directives:[{name:"selectonfocus",rawName:"v-selectonfocus"},{name:"model",rawName:"v-model",value:t.cotizacion.cantidad,expression:"cotizacion.cantidad"}],ref:"refCantidad",staticClass:"form-control col-sm-4 col-md-3",class:{hasError:t.hasErrorCantidad},attrs:{id:"cantidad",type:"text",disabled:t.disabledCotizacion},domProps:{value:t.cotizacion.cantidad},on:{change:function(e){t.hasErrorCantidad=!1},focus:function(e){return t.onFocus(1)},keypress:t.numerosDecimales,input:function(e){e.target.composing||t.$set(t.cotizacion,"cantidad",e.target.value)}}}),n("label",{staticClass:"labelSize col-4",attrs:{for:"cantidad"}},[n("p",[t._v("m"),n("sup",[t._v("3")])])])])]),n("div",{staticClass:"form-group col-sm-12"},[n("div",{staticClass:"row"},[n("div",{staticClass:"form-group col-sm-12 col-md-5"},[n("label",[t._v("Precio por m³ original")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.cotizacion.precioOriginal,expression:"cotizacion.precioOriginal"}],staticClass:"form-control col-sm-12",attrs:{type:"text",disabled:""},domProps:{value:t.cotizacion.precioOriginal},on:{input:function(e){e.target.composing||t.$set(t.cotizacion,"precioOriginal",e.target.value)}}})]),t.cotizacion.tieneDescuento?n("div",{staticClass:"form-group col-sm-12 col-md-7 mb-2"},[n("label",[t._v("Precio por m³ con descuento")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.cotizacion.precioDescuento,expression:"cotizacion.precioDescuento"}],staticClass:"form-control col-sm-12 col-md-9",attrs:{type:"text",disabled:""},domProps:{value:t.cotizacion.precioDescuento},on:{input:function(e){e.target.composing||t.$set(t.cotizacion,"precioDescuento",e.target.value)}}})]):t._e(),n("div",{staticClass:"form-group col-sm-12 my-2 text-center"},[n("label",{staticClass:"mr-3"},[n("span",[t._v("* El precio que se otorgue, afectará directamente a facturación. *")])])])])])])])],1)],1)},a=[],r=(n("99af"),n("4de4"),n("4160"),n("caad"),n("c975"),n("fb6a"),n("a434"),n("b680"),n("d3b7"),n("25f0"),n("2532"),n("498a"),n("159b"),n("96cf"),n("1da1")),i=n("e6d6"),c=n("65a8"),s=n("e845"),u=n("5a30a"),l=n("3d20"),d=n.n(l),f={data:function(){return{mostrarDescuento:!1,hasErrorCte:!1,hasErrorObra:!1,hasErrorVendedor:!1,hasErrorCantidad:!1,hasErrorDescuento:!1,disabledObras:!0,disabledClientes:!1,mostrarOperadores:!0,distanciaActual:"0",tiempoActual:"0",clientes:[{value:0,text:"Seleccione el cliente"}],obras:[{value:0,text:"Seleccione la obra del cliente"}],vendedores:[{value:0,text:"Seleccione el vendedor"}],plantas:[{value:0,text:"Seleccione una planta"}],cotizacion:{folioCotizacion:0,codCliente:0,codObra:0,codVendedor:0,cantidad:0,cantidadTotal:0,producto:"",codProducto:0,estatus:"",tieneDescuento:!1,porcentajeDescuento:0,observacion:"",codPlanta:0,tieneFibra:!1,tieneImper:!1,precioOriginal:0,precioDescuento:0,bombeado:!1,otroCliente:"",otraObra:"",productos:[]},inputSeleccionado:0,parametro:0,disabledFormula:!0,nuevaFormula:!1,mostrarProducto:!1,state:"",formulasFiltradas:[],formulas:[],formulaNueva:"",hasErrorProducto:!1,disabledlimpiarProductos:!1,modal:!1,disabledVendedor:!1,disabledCotizacion:!1,continuarGuardado:!1,disabledPlanta:!1,disabledPrecio:!1,modalProductos:!1,listaProductos:[],folioCotizacion:0}},components:{},watch:{state:function(t){t.length>=1&&0==this.cotizacion.codProducto?this.modal=!0:this.modal=!1,0===t.length&&(this.cotizacion.producto=0,this.cotizacion.codProducto=0,this.mostrarProducto=!1,this.precios=[])}},mounted:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.cargarFormulas(0);case 2:if(t.parametro=void 0!=t.$route.params.id?t.$route.params.id:0,!(t.parametro>0)){e.next=6;break}return e.next=6,t.cargaCotizacion();case 6:case"end":return e.stop()}}),e)})))()},created:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(1!==t.usuario.agente){e.next=7;break}t.disabledVendedor=!0,t.vendedores=[{value:t.usuario.codEmpleado,text:t.usuario.nombre}],t.cotizacion.codVendedor=t.vendedores[0].value,t.obtenerClientes(),e.next=11;break;case 7:return t.disabledVendedor=!1,e.next=10,t.obtenerVendedores();case 10:t.disabledClientes=!0;case 11:case"end":return e.stop()}}),e)})))()},computed:{},methods:{calcularDescuento:function(){this.cotizacion.precioDescuento=(this.cotizacion.precioOriginal-this.cotizacion.porcentajeDescuento/100*this.cotizacion.precioOriginal).toFixed(2)},obtenerClientes:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.hasErrorVendedor=!1,t.hasErrorCte=!1,t.hasErrorObra=!1,t.clientes=[{value:0,text:"Seleccione el cliente"}],t.cotizacion.codCliente=t.clientes[0].value,t.obras=[{value:0,text:"Seleccione la obra del cliente"}],t.cotizacion.codObra=t.obras[0].value,t.disabledObras=!0,!(t.cotizacion.codVendedor>0)){e.next=16;break}return t.$loading(!0),e.next=12,c["a"].obtenerClientesAgente(t.cotizacion.codVendedor).then((function(e){if(e.value){e.data.forEach((function(e){var n={value:e.codigo,text:e.nombreCompleto};t.clientes.push(n)}));var n={value:-1,text:"Otro"};t.clientes.push(n)}}));case 12:t.disabledClientes=!1,t.$loading(!1),e.next=17;break;case 16:t.disabledClientes=!0;case 17:case"end":return e.stop()}}),e)})))()},obtenerPrecios:function(t,e){var n=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n.$loading(!0),t.next=3,i["a"].obtenerFormulas(e).then((function(t){n.$loading(!1),t.value&&(n.cotizacion.tieneDescuento?(n.cotizacion.precioOriginal=t.data[0].precioMaximo,n.cotizacion.precioDescuento=(n.cotizacion.precioOriginal-n.cotizacion.porcentajeDescuento/100*n.cotizacion.precioOriginal).toFixed(2)):n.cotizacion.precioOriginal=t.data[0].precioMaximo.toFixed(2))})).catch((function(t){n.$loading(!1),console.error(t)}));case 3:case"end":return t.stop()}}),t)})))()},changeCliente:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.obtenerDescuentoCliente();case 2:return e.next=4,t.obtenerObras();case 4:case"end":return e.stop()}}),e)})))()},obtenerDescuentoCliente:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u["a"].obtenerUltimoDescuentoCliente(t.cotizacion.codVendedor,t.cotizacion.codCliente);case 2:if(n=e.sent,!n.value){e.next=8;break}return e.next=6,d.a.fire({title:"¡ATENCIÓN!",text:"El ultimo descuento asignado al cliente fue de ".concat(n.data[0].porcentajeDescuento,"%, ¿Deseas aplicarlo?"),icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Aceptar",cancelButtonText:"Cancelar"});case 6:o=e.sent,o.value?(t.cotizacion.tieneDescuento=!0,t.cotizacion.porcentajeDescuento=n.data[0].porcentajeDescuento):(t.cotizacion.tieneDescuento=!1,t.cotizacion.porcentajeDescuento=0);case 8:t.mostrarDescuento=!0;case 9:case"end":return e.stop()}}),e)})))()},obtenerObras:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.hasErrorObra=!1,t.cotizacion.otraObra="",n=t.cotizacion.codCliente,t.cotizacion.codObra=0,t.obras=[{value:0,text:"Seleccione la obra del cliente"}],t.$loading(!0),e.next=8,i["a"].obtenerObras(n).then((function(e){if(t.$loading(!1),e.value){t.disabledObras=!1,t.hasErrorCte=!1,e.data.forEach((function(e){var n={value:e.codigo,text:e.calleNumero};t.obras.push(n)}));var n={value:-1,text:"Otra"};t.obras.push(n)}else t.disabledObras=!0}));case 8:t.$loading(!1);case 9:case"end":return e.stop()}}),e)})))()},obraSeleccionada:function(){this.hasErrorObra=!1},obtenerVendedores:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$loading(!0),e.next=3,s["a"].agentesCombo().then((function(e){e.value&&e.data.forEach((function(e){var n={value:e.codVendedor,text:e.nombreVendedor};t.vendedores.push(n)}))}));case 3:t.$loading(!1);case 4:case"end":return e.stop()}}),e)})))()},guardarCotizacion:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.validarRegistros()){e.next=7;break}return e.next=3,d.a.fire({title:"¡ATENCIÓN!",text:"¿Desea guardar la cotización?",showCancelButton:!0,icon:"question",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Aceptar",cancelButtonText:"Cancelar"});case 3:n=e.sent,n.value&&(t.continuarGuardado=!0),e.next=8;break;case 7:t.listaProductos.length<=0?t.$swal.fire({text:"No hay productos agregados a la cotización.",icon:"error"}):t.$swal.fire({text:"Hay campos requeridos por completar",icon:"error"});case 8:if(!t.continuarGuardado){e.next=29;break}return e.next=11,t.CapturarObservacion();case 11:return t.continuarGuardado&&console.log("guardo"),t.cotizacion.productos=t.listaProductos,t.$loading(!0),e.next=16,u["a"].guardarCotizacion(t.cotizacion);case 16:if(o=e.sent,!o.value){e.next=27;break}return t.folioCotizacion=o.data,t.$loading(!1),e.next=22,t.obtenerCotizacion();case 22:return e.next=24,d.a.fire("¡EXITO!",o.message,"success");case 24:t.$router.push({path:"/agente-de-ventas/cotizaciones"}),e.next=29;break;case 27:t.$loading(!1),t.$swal.fire({text:o.message,icon:"error"});case 29:case"end":return e.stop()}}),e)})))()},cancelar:function(){return Object(r["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d.a.fire({title:"¡ATENCIÓN!",text:"¿Desea cancelar el registro de la cotización?",showCancelButton:!0,icon:"question",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Aceptar",cancelButtonText:"Cancelar"});case 2:e=t.sent,e.value&&window.history.back();case 4:case"end":return t.stop()}}),t)})))()},validarRegistros:function(){var t=!1;return this.cotizacion.codCliente<=0&&(""===this.cotizacion.otroCliente?(this.hasErrorCte=!0,t=!0):this.hasErrorCte=!1),this.cotizacion.codObra<=0&&(""===this.cotizacion.otraObra?(this.hasErrorObra=!0,t=!0):this.hasErrorObra=!1),0===this.cotizacion.codVendedor&&(this.hasErrorVendedor=!0,t=!0),this.listaProductos.length<=0&&(t=!0),this.cotizacion.tieneDescuento&&this.cotizacion.porcentajeDescuento<=0&&(this.hasErrorDescuento=!0,t=!0),t},inicializarDatos:function(){this.cotizacion={codCliente:0,codObra:0,codVendedor:0,cantidad:0}},numerosDecimales:function(t){var e=t.keyCode?t.keyCode:t.which;1==this.inputSeleccionado&&(!(e<48||e>57)||46===e&&-1==this.cotizacion.cantidad.indexOf(".")||t.preventDefault())},onFocus:function(t){this.inputSeleccionado=t},cargaCotizacion:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,o,a,r,i,c,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(t.parametro>0)){e.next=20;break}return n=new Date,o=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=o.toISOString().slice(0,10),r=0,i=0,c="",s="",t.$loading(!0),e.next=10,u["a"].obtenerCotizaciones(t.parametro,a,a).then((function(e){e.value?(console.log("R -> ",e),t.cotizacion.folioCotizacion=e.data[0].folioCotizacion,t.cotizacion.codVendedor=e.data[0].codVendedor,i=e.data[0].codCliente,t.cotizacion.cantidad=e.data[0].cantidad,t.cotizacion.codProducto=e.data[0].codProducto,t.cotizacion.estatus=e.data[0].estatus,t.cotizacion.tieneDescuento=e.data[0].tieneDescuento,t.cotizacion.porcentajeDescuento=e.data[0].porcentajeDescuento,r=e.data[0].codObra,c=e.data[0].cliente,s=e.data[0].obra,t.$loading(!1)):(t.$loading(!1),t.$swal.fire({text:"".concat(e.message),icon:"error"}),t.$router.push({path:"/agente-de-ventas/cotizaciones"}))}));case 10:return e.next=12,t.obtenerClientes();case 12:return t.cotizacion.codCliente=i,e.next=15,t.obtenerObras();case 15:return t.cotizacion.codObra=r,i<0&&(t.cotizacion.otroCliente=c),r<0&&(t.cotizacion.otraObra=s),e.next=20,t.CargarProductosCotizacion();case 20:case"end":return e.stop()}}),e)})))()},cargarFormulas:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.$loading(!0),n.next=3,e.obtenerFormulas(t);case 3:o=n.sent,o.value&&o.data.forEach((function(t){var n={value:t.codigo,text:"".concat(t.nomenclatura," - ").concat(t.descripcion),producto:t.nomenclatura};e.formulas.push(n)})),e.$loading(!1);case 6:case"end":return n.stop()}}),n)})))()},obtenerFormulas:function(t){return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["a"].obtenerFormulas(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()},filterState:function(){var t=this;this.formulasFiltradas=this.formulas.filter((function(e){var n=e.text.toString().toUpperCase(),o=e.producto.toString().toUpperCase(),a=t.state.trim().toUpperCase();return n.includes(a)||o.includes(a)}))},setState:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.cotizacion.codProducto=t.value,e.state=t.text,e.cotizacion.producto=t.producto,e.modal=!1,e.mostrarProducto=!0,e.hasErrorProducto=!1,e.disabledFormula=!0,n.next=9,e.obtenerPrecios(e.cotizacion.codCliente,t.value);case 9:case"end":return n.stop()}}),n)})))()},obtenerFormulaProducto:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.formulas.filter((function(e){return e.value==t}));case 2:return o=n.sent,n.next=5,e.setState(o[0]);case 5:case"end":return n.stop()}}),n)})))()},focusInputFormula:function(){this.state.length>0&&(this.modal=!0)},limpiarProducto:function(){this.cotizacion.producto=0,this.cotizacion.codProducto=0,this.cotizacion.cantidad=0,this.cotizacion.precioOriginal="",this.cotizacion.precioDescuento="",this.state=""},restablecerDatosModal:function(){this.cotizacion.producto=0,this.cotizacion.codProducto=0,this.cotizacion.cantidad=0,this.cotizacion.precioOriginal="",this.state=""},habilitarFormula:function(){var t=this;this.disabledFormula=!1,this.cotizacion.producto=0,this.cotizacion.codProducto=0,this.mostrarProducto=!1,this.state="",this.$nextTick((function(){t.$refs.refFormula.focus()}))},CapturarObservacion:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,o,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,d.a.fire({title:"Ingrese una observación:",html:'<textarea id="swal-input2" class="swal2-input" placeholder="Capture una observación" style="margin-top: 20px; margin-bottom: 20px; height: 120px;">',focusConfirm:!1,showCancelButton:!1,confirmButtonText:"Aceptar",confirmButtonColor:"#3085d6",preConfirm:function(){n=d.a.getPopup().querySelector("#swal-input2").value;var t=d.a.getPopup().querySelector("#swal-input2");t.style.borderColor=""}});case 2:o=e.sent,a=o.value,a?(t.cotizacion.observacion=n,t.continuarGuardado=!0):t.continuarGuardado=!1;case 5:case"end":return e.stop()}}),e)})))()},buscarProducto:function(){this.modalProductos=!0,this.limpiarProducto()},agregarProductoCotizacion:function(){if(this.cotizacion.codProducto>0)if(this.cotizacion.cantidad>0){var t={codProducto:this.cotizacion.codProducto,descripcion:this.state,cantidad:this.cotizacion.cantidad,precioOriginal:this.cotizacion.tieneDescuento?this.cotizacion.precioDescuento:this.cotizacion.precioOriginal};this.listaProductos.push(t),this.restablecerDatosModal(),this.modalProductos=!1}else this.$swal.fire({text:"Tiene que ingresar la cantidad de metros.",icon:"warning"});else this.$swal.fire({text:"Tiene que seleccionar un producto.",icon:"warning"})},borrarProducto:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,d.a.fire({text:"¿Desea eliminar el producto de la cotización?",title:"¡ATENCIÓN!",showCancelButton:!0,icon:"question",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Aceptar",cancelButtonText:"Cancelar"});case 2:o=n.sent,o.value&&e.listaProductos.splice(t,1);case 4:case"end":return n.stop()}}),n)})))()},obtenerCotizacion:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$loading(!0),e.next=3,u["a"].obtenerPDFCotizacion(t.folioCotizacion);case 3:if(n=e.sent,!n.value){e.next=12;break}return e.next=7,t.ImprimirCotizacion(n.data);case 7:t.$loading(!1),o=t.$swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:function(e){e.addEventListener("mouseenter",t.$swal.stopTimer),e.addEventListener("mouseleave",t.$swal.resumeTimer)}}),o.fire({icon:"success",title:"Se genero la cotizacion correctamente descargado."}),e.next=14;break;case 12:t.$loading(!1),t.$swal.fire({text:n.message,icon:"warning"});case 14:case"end":return e.stop()}}),e)})))()},ImprimirCotizacion:function(t){return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=document.createElement("a"),o="Cotización",n.href="data:application/pdf;base64,"+t,n.download=o,e.next=6,n.click();case 6:case"end":return e.stop()}}),e)})))()},CargarProductosCotizacion:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$loading(!0),e.next=3,u["a"].cargarProductosCotizacion(t.cotizacion.folioCotizacion);case 3:n=e.sent,n.value&&n.data.forEach((function(e){var n={codProducto:e.codigo,descripcion:e.descripcion,cantidad:e.cantidad,precioOriginal:e.precio};t.listaProductos.push(n)})),t.$loading(!1);case 6:case"end":return e.stop()}}),e)})))()}}},p=f,m=(n("c346"),n("2877")),h=Object(m["a"])(p,o,a,!1,null,"38ad1afc",null);e["default"]=h.exports},"99af":function(t,e,n){"use strict";var o=n("23e7"),a=n("d039"),r=n("e8b5"),i=n("861d"),c=n("7b0b"),s=n("50c4"),u=n("8418"),l=n("65f0"),d=n("1dde"),f=n("b622"),p=n("2d00"),m=f("isConcatSpreadable"),h=9007199254740991,b="Maximum allowed index exceeded",g=p>=51||!a((function(){var t=[];return t[m]=!1,t.concat()[0]!==t})),v=d("concat"),C=function(t){if(!i(t))return!1;var e=t[m];return void 0!==e?!!e:r(t)},x=!g||!v;o({target:"Array",proto:!0,forced:x},{concat:function(t){var e,n,o,a,r,i=c(this),d=l(i,0),f=0;for(e=-1,o=arguments.length;e<o;e++)if(r=-1===e?i:arguments[e],C(r)){if(a=s(r.length),f+a>h)throw TypeError(b);for(n=0;n<a;n++,f++)n in r&&u(d,f,r[n])}else{if(f>=h)throw TypeError(b);u(d,f++,r)}return d.length=f,d}})},a434:function(t,e,n){"use strict";var o=n("23e7"),a=n("23cb"),r=n("a691"),i=n("50c4"),c=n("7b0b"),s=n("65f0"),u=n("8418"),l=n("1dde"),d=n("ae40"),f=l("splice"),p=d("splice",{ACCESSORS:!0,0:0,1:2}),m=Math.max,h=Math.min,b=9007199254740991,g="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!f||!p},{splice:function(t,e){var n,o,l,d,f,p,v=c(this),C=i(v.length),x=a(t,C),z=arguments.length;if(0===z?n=o=0:1===z?(n=0,o=C-x):(n=z-2,o=h(m(r(e),0),C-x)),C+n-o>b)throw TypeError(g);for(l=s(v,o),d=0;d<o;d++)f=x+d,f in v&&u(l,d,v[f]);if(l.length=o,n<o){for(d=x;d<C-o;d++)f=d+o,p=d+n,f in v?v[p]=v[f]:delete v[p];for(d=C;d>C-o+n;d--)delete v[d-1]}else if(n>o)for(d=C-o;d>x;d--)f=d+o-1,p=d+n-1,f in v?v[p]=v[f]:delete v[p];for(d=0;d<n;d++)v[d+x]=arguments[d+2];return v.length=C-o+n,l}})},ab13:function(t,e,n){var o=n("b622"),a=o("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[a]=!1,"/./"[t](e)}catch(o){}}return!1}},b1c8:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container mt-3"},[n("b-modal",{attrs:{id:t.infoModal.id,title:t.infoModal.title,"ok-only":"",codigo:t.infoModal.codigo,"hide-footer":""},on:{hide:t.resetInfoModal}},[t._l(t.infoModal.content,(function(e,o){return n("tr",{key:o},[n("th",[t._v(t._s(o))]),"Observación"!=o&&"Observacion"!=o?n("td",[t._v(t._s(e))]):t._e(),"Observación"==o||"Observacion"==o?n("td",{staticClass:"text-danger font-weight-bold"},[t._v(t._s(e))]):t._e()])})),n("b-button",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"mt-3",attrs:{variant:"outline-primary",block:"",to:t.rutaNuevo+"?id="+t.idSeleccionado}},[n("i",{staticClass:"fa fa-eye"}),t._v(" Más información ")])],2),t._m(0),n("b-row",[n("div",{staticClass:"form-group col-sm-12 col-md-6 col-lg-5 col-xl-4 mb-1"},[n("label",[t._v("Desde:")]),n("b-form-datepicker",{staticClass:"mb-2",attrs:{locale:"es",size:"sm"},model:{value:t.desde,callback:function(e){t.desde=e},expression:"desde"}})],1),n("div",{staticClass:"form-group col-sm-12 col-md-6 col-lg-5 col-xl-4 mb-1"},[n("label",[t._v("Hasta:")]),n("b-form-datepicker",{staticClass:"mb-2",attrs:{locale:"es",size:"sm"},model:{value:t.hasta,callback:function(e){t.hasta=e},expression:"hasta"}})],1)]),n("b-row",{staticClass:"d-flex justify-content-between"},[n("div",{staticClass:"col-sm-12 col-md-4 col-lg-2 mb-2"},[n("b-button",{staticClass:"mr-2",attrs:{block:"",variant:"success"},on:{click:t.buscarCotizaciones}},[n("i",{staticClass:"fa fa-search"}),t._v(" Buscar ")])],1)]),n("b-row",{staticClass:"my-2"},[n("b-col",{attrs:{md:"4"}},[n("b-form-group",{attrs:{label:"Filtrar","label-cols-sm":"1","label-cols-md":"2","label-size":"sm","label-for":"filterInput"}},[n("b-input-group",{attrs:{size:"sm"}},[n("b-form-input",{attrs:{type:"search",id:"filterInput",placeholder:"Escribe el filtro...",autocomplete:"off"},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),n("b-input-group-append",[n("b-button",{attrs:{disabled:!t.filter},on:{click:function(e){t.filter=""}}},[n("i",{staticClass:"fas fa-times"})])],1)],1)],1)],1),n("b-col",{attrs:{md:"3"}},[n("b-form-group",{attrs:{label:"Por página","label-cols-sm":"2","label-cols-md":"2","label-cols-lg":"4","label-size":"sm","label-for":"perPageSelect"}},[n("b-form-select",{attrs:{id:"perPageSelect",size:"sm",options:t.pageOptions},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1),n("b-col",{attrs:{md:"3","offset-md":"2"}},[n("b-button",{staticClass:"btn btn-sm py-1 mt-1 btn-block",attrs:{variant:"primary"},on:{click:t.redirect}},[n("i",{staticClass:"fa fa-plus"}),t._v(" Nueva cotización ")])],1)],1),n("b-table",{attrs:{small:"",stacked:"md","head-variant":"dark",hover:t.hover,striped:t.striped,bordered:t.bordered,items:t.items,fields:t.fields,"current-page":t.currentPage,"per-page":t.perPage,filter:t.filter,filterIncludedFields:t.filterOn,"sort-by":t.sortBy,"sort-desc":t.sortDesc,"sort-direction":t.sortDirection},on:{"update:sortBy":function(e){t.sortBy=e},"update:sort-by":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"update:sort-desc":function(e){t.sortDesc=e},filtered:t.onFiltered},scopedSlots:t._u([{key:"cell(estatusCotizacion)",fn:function(e){return["A"===e.item.estatus?n("b-badge",{staticClass:"p-2",attrs:{variant:"success"}},[t._v(" Aceptada ")]):t._e(),"P"===e.item.estatus?n("b-badge",{staticClass:"p-2",attrs:{variant:"secondary"}},[t._v(" Pendiente ")]):t._e(),"R"===e.item.estatus?n("b-badge",{staticClass:"p-2",attrs:{variant:"danger"}},[t._v(" Rechazada ")]):t._e()]}},{key:"cell(actions)",fn:function(e){return[n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"mr-1",attrs:{size:"sm",title:"Ver Detalle",variant:"outline-info"},on:{click:function(n){return t.modal(e.item,e.index,n.target)}}},[n("i",{staticClass:"fa fa-eye"})]),n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"mr-1",attrs:{to:t.rutaNuevo+e.item.folioCotizacion,disabled:"C"==e.item.estatus,size:"sm",title:"Editar",variant:"outline-info"}},[n("i",{staticClass:"fa fa-edit"})])]}},{key:"cell(actionsReimprimir)",fn:function(e){return[n("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{variant:"dark",size:"sm",title:"Reimprimir Cotización"},on:{click:function(n){return t.obtenerCotizacion(e.item.folioCotizacion)}}},[n("i",{staticClass:"fa fa-print mr-2"}),t._v("Reimprimir ")])]}}])}),n("b-pagination",{staticClass:"mt-1",attrs:{"total-rows":t.totalRows,"per-page":t.perPage,align:"center","aria-controls":"my-table"},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)},a=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mt-3"},[n("h3",[n("i",{staticClass:"fas fa-file-invoice-dollar"}),t._v(" Cotizaciones")])])}],r=(n("4de4"),n("d81d"),n("fb6a"),n("96cf"),n("1da1")),i=n("5a30a"),c={data:function(){var t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate()),n=e.toISOString().slice(0,10);return{desde:n,hasta:n,items:[],totalRows:1,currentPage:1,perPage:5,pageOptions:[5,10,15],sortBy:"",sortDesc:!1,bordered:!0,hover:!0,striped:!0,sortDirection:"asc",filter:null,filterOn:[],fields:[{key:"folioCotizacion",label:"Cotización",sortable:!0,sortDirection:"desc"},{key:"cliente",label:"Cliente",sortable:!0,sortDirection:"desc"},{key:"fechaRecepcion",label:"Fecha Envio",sortable:!0,class:"text-center"},{key:"estatusCotizacion",label:"Estatus",sortable:!0,class:"text-center"},{key:"actions",label:"",class:"text-center"},{key:"actionsReimprimir",label:"",class:"text-center"}],permisoEscritura:!0,rutaNuevo:"cotizaciones/registro/",modalShow:!1,headerBgVariant:"dark",headerTextVariant:"light",infoModal:{id:"info-modal",title:"",content:"",codigo:""},idSeleccionado:0}},components:{},mounted:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.ObtenerCotizaciones();case 2:return e.next=4,t.CargarRenglones();case 4:case"end":return e.stop()}}),e)})))()},created:function(){},computed:{sortOptions:function(){return this.fields.filter((function(t){return t.sortable})).map((function(t){return{text:t.label,value:t.key}}))}},methods:{onFiltered:function(t){this.totalRows=t.length,this.currentPage=1},buscarCotizaciones:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.ObtenerCotizaciones();case 2:case"end":return e.stop()}}),e)})))()},ObtenerCotizaciones:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$loading(!0),e.next=3,i["a"].obtenerCotizaciones(0,t.desde,t.hasta).then((function(e){t.items=e.data,t.$loading(!1)})).catch((function(t){console.log(t)}));case 3:case"end":return e.stop()}}),e)})))()},redirect:function(){var t=this;setTimeout((function(){t.$router.push({path:"".concat(t.rutaNuevo,"0")})}),500)},CargarRenglones:function(){var t=this;setTimeout((function(){t.totalRows=t.items.length}),1e3)},modal:function(t,e,n){var o="";this.idSeleccionado=t.codigo,this.infoModal.title="Datos de la cotización #".concat(t.folioCotizacion),o+="{ ",o+='"Folio Cotización" : ": '.concat(t.folioCotizacion,'\\n\\n", '),o+='"Cliente" : ":  '.concat(t.cliente,'\\n\\n",'),o+='"Fecha de Recepcion" : ":  '.concat(t.fechaRecepcion,'\\n\\n",'),o+='"Obra" : ":  '.concat(t.obra,'\\n\\n",'),o+='"Cantidad" : ":  '.concat(t.cantidad,' m³\\n\\n",'),o+='"Vendedor" : ":  '.concat(t.vendedor,'\\n\\n",'),o+='"Usuario" : ":  '.concat(t.usuario,'\\n\\n",'),o+='"Observación" : ":  '.concat(t.observacion,'\\n\\n",'),o+='"E-1" : ":  '.concat(t.tieneFibra?" Fibra ":"N/A",' \\n\\n",'),o+='"E-2" : ":  '.concat(t.tieneImper?" Imper ":"N/A",' \\n\\n"'),o+="}",o=JSON.parse(o),this.infoModal.content=o,this.$root.$emit("bv::show::modal",this.infoModal.id,n)},resetInfoModal:function(){this.infoModal.title="",this.infoModal.content=""},obtenerCotizacion:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.$loading(!0),n.next=3,i["a"].obtenerPDFCotizacion(t);case 3:if(o=n.sent,!o.value){n.next=12;break}return n.next=7,e.ImprimirCotizacion(o.data);case 7:e.$loading(!1),a=e.$swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:function(t){t.addEventListener("mouseenter",e.$swal.stopTimer),t.addEventListener("mouseleave",e.$swal.resumeTimer)}}),a.fire({icon:"success",title:"Se reimprimio la cotización correctamente."}),n.next=14;break;case 12:e.$loading(!1),e.$swal.fire({text:o.message,icon:"warning"});case 14:case"end":return n.stop()}}),n)})))()},ImprimirCotizacion:function(t){return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=document.createElement("a"),o="Cotización",n.href="data:application/pdf;base64,"+t,n.download=o,e.next=6,n.click();case 6:case"end":return e.stop()}}),e)})))()}}},s=c,u=n("2877"),l=Object(u["a"])(s,o,a,!1,null,"5f8c8e6c",null);e["default"]=l.exports},b680:function(t,e,n){"use strict";var o=n("23e7"),a=n("a691"),r=n("408a"),i=n("1148"),c=n("d039"),s=1..toFixed,u=Math.floor,l=function(t,e,n){return 0===e?n:e%2===1?l(t,e-1,n*t):l(t*t,e/2,n)},d=function(t){var e=0,n=t;while(n>=4096)e+=12,n/=4096;while(n>=2)e+=1,n/=2;return e},f=s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!c((function(){s.call({})}));o({target:"Number",proto:!0,forced:f},{toFixed:function(t){var e,n,o,c,s=r(this),f=a(t),p=[0,0,0,0,0,0],m="",h="0",b=function(t,e){var n=-1,o=e;while(++n<6)o+=t*p[n],p[n]=o%1e7,o=u(o/1e7)},g=function(t){var e=6,n=0;while(--e>=0)n+=p[e],p[e]=u(n/t),n=n%t*1e7},v=function(){var t=6,e="";while(--t>=0)if(""!==e||0===t||0!==p[t]){var n=String(p[t]);e=""===e?n:e+i.call("0",7-n.length)+n}return e};if(f<0||f>20)throw RangeError("Incorrect fraction digits");if(s!=s)return"NaN";if(s<=-1e21||s>=1e21)return String(s);if(s<0&&(m="-",s=-s),s>1e-21)if(e=d(s*l(2,69,1))-69,n=e<0?s*l(2,-e,1):s/l(2,e,1),n*=4503599627370496,e=52-e,e>0){b(0,n),o=f;while(o>=7)b(1e7,0),o-=7;b(l(10,o,1),0),o=e-1;while(o>=23)g(1<<23),o-=23;g(1<<o),b(1,1),g(2),h=v()}else b(0,n),b(1<<-e,0),h=v()+i.call("0",f);return f>0?(c=h.length,h=m+(c<=f?"0."+i.call("0",f-c)+h:h.slice(0,c-f)+"."+h.slice(c-f))):h=m+h,h}})},c346:function(t,e,n){"use strict";var o=n("ec16"),a=n.n(o);a.a},c8d2:function(t,e,n){var o=n("d039"),a=n("5899"),r="​᠎";t.exports=function(t){return o((function(){return!!a[t]()||r[t]()!=r||a[t].name!==t}))}},caad:function(t,e,n){"use strict";var o=n("23e7"),a=n("4d64").includes,r=n("44d2"),i=n("ae40"),c=i("indexOf",{ACCESSORS:!0,1:0});o({target:"Array",proto:!0,forced:!c},{includes:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),r("includes")},d81d:function(t,e,n){"use strict";var o=n("23e7"),a=n("b727").map,r=n("1dde"),i=n("ae40"),c=r("map"),s=i("map");o({target:"Array",proto:!0,forced:!c||!s},{map:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},e6d6:function(t,e,n){"use strict";n("99af");var o=n("572a"),a={obtenerUltimoFolioGinco:function(){return o["a"].get("/dosificador/ultimo-folio-ginco").then((function(t){return t.data})).catch((function(t){return t}))},obtenerNotasRemisionCanceladas:function(){return o["a"].get("/dosificador/notasRemision-canceladas").then((function(t){return t.data})).catch((function(t){return t}))},obtenerUltimoFolioNR:function(){return o["a"].get("/dosificador/ultimo-folio-notaRemision").then((function(t){return t.data})).catch((function(t){return t}))},agentesClientes:function(t){return o["a"].get("/agentes/clientes/".concat(t)).then((function(t){return t.data})).catch((function(t){return t}))},obtenerFormulas:function(t){return o["a"].get("/dosificador/formulas/".concat(t)).then((function(t){return t.data})).catch((function(t){return t}))},obtenerPedido:function(t){return o["a"].get("/dosificador/folio-pedido/".concat(t)).then((function(t){return t.data})).catch((function(t){return t}))},verificarPedido:function(t){return o["a"].get("/dosificador/verificar-notasRemision-pedido/".concat(t)).then((function(t){return t.data})).catch((function(t){return t}))},obtenerOperadores:function(t){return o["a"].get("/dosificador/operadores/".concat(t)).then((function(t){return t.data})).catch((function(t){return t}))},obtenerOperadoresCamionRevolvedor:function(){return o["a"].get("/dosificador/operadores-camion-revolvedor").then((function(t){return t.data})).catch((function(t){return t}))},obtenerOperadoresCamionBombeable:function(){return o["a"].get("/dosificador/operadores-camion-bombeable").then((function(t){return t.data})).catch((function(t){return t}))},obtenerObras:function(t){return o["a"].get("/dosificador/obras-clientes/".concat(t)).then((function(t){return t.data})).catch((function(t){return t}))},obtenerEquipo:function(t,e){return o["a"].get("/dosificador/equipo-operador/".concat(t,"/").concat(e)).then((function(t){return t.data})).catch((function(t){return t}))},obtenerNotasEspecialRelacionadas:function(t,e){return o["a"].get("/dosificador/notasRemision-especial/".concat(t,"/").concat(e)).then((function(t){return t.data})).catch((function(t){return t}))},obtenerPdfNotaRemision:function(t){return o["a"].get("/dosificador/notaRemision/pdf/".concat(t)).then((function(t){return t.data})).catch((function(t){return t}))},guardarNotaRemision:function(t,e){return o["a"].post("/dosificador/notaRemision/guardar",t,e,{headers:{"Content-Type":"application/json"}}).then((function(t){return t.data})).catch((function(t){console.log(t)}))},agregarNotaRemisionEspecial:function(t){return o["a"].post("/dosificador/notaRemision/agregar-nota",t,{headers:{"Content-Type":"application/json"}}).then((function(t){return t.data})).catch((function(t){console.log(t)}))},cancelarNotaRemision:function(t){return o["a"].post("/dosificador/notaRemision/cancelar",t,{headers:{"Content-Type":"application/json"}}).then((function(t){return t.data})).catch((function(t){console.log(t)}))},guardarFormula:function(t){return o["a"].post("/dosificador/formula/guardar",t,{headers:{"Content-Type":"application/json"}}).then((function(t){return t.data})).catch((function(t){console.log(t)}))},guardarProductosFormula:function(t,e){return o["a"].post("/dosificador/productos-formula/guardar",{productos:t,modificarDatos:e},{headers:{"Content-Type":"application/json"}}).then((function(t){return t.data})).catch((function(t){console.log(t)}))}};e["a"]=a},e845:function(t,e,n){"use strict";n("99af");var o=n("572a"),a={agentesCombo:function(){return o["a"].get("/agentes/todosCombo").then((function(t){return t.data})).catch((function(t){console.log(t)}))},obtenerPedidosAgente:function(){return o["a"].get("/agentes/pedidos").then((function(t){return t.data})).catch((function(t){console.log(t)}))},obtenerClientes:function(t){return o["a"].get("/agentes/clientes/".concat(t)).then((function(t){return t.data})).catch((function(t){console.log(t)}))},obtenerProductosXCliente:function(t,e){return o["a"].get("/agentes/productos-cliente/".concat(t,"/").concat(e)).then((function(t){return t.data})).catch((function(t){console.log(t)}))},obtenerDetalleNotasRemisionAgente:function(t){return o["a"].get("/agentes/notas-remision-detalle/".concat(t)).then((function(t){return t.data})).catch((function(t){console.log(t)}))},guardarPrecioProducto:function(t){return o["a"].post("/agentes/guardar-precio-productoXCliente",t,{headers:{"Content-Type":"application/json"}}).then((function(t){return t.data})).catch((function(t){console.log(t)}))}};e["a"]=a},ec16:function(t,e,n){},fb6a:function(t,e,n){"use strict";var o=n("23e7"),a=n("861d"),r=n("e8b5"),i=n("23cb"),c=n("50c4"),s=n("fc6a"),u=n("8418"),l=n("b622"),d=n("1dde"),f=n("ae40"),p=d("slice"),m=f("slice",{ACCESSORS:!0,0:0,1:2}),h=l("species"),b=[].slice,g=Math.max;o({target:"Array",proto:!0,forced:!p||!m},{slice:function(t,e){var n,o,l,d=s(this),f=c(d.length),p=i(t,f),m=i(void 0===e?f:e,f);if(r(d)&&(n=d.constructor,"function"!=typeof n||n!==Array&&!r(n.prototype)?a(n)&&(n=n[h],null===n&&(n=void 0)):n=void 0,n===Array||void 0===n))return b.call(d,p,m);for(o=new(void 0===n?Array:n)(g(m-p,0)),l=0;p<m;p++,l++)p in d&&u(o,l,d[p]);return o.length=l,o}})},fdbc:function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}}}]);
//# sourceMappingURL=Cotizaciones.2f5b4c68.js.map